(()=>{"use strict";var e,t,s,r,a,o={7097:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),r(s(1094)).default.config();const a=r(s(864)),o=r(s(9973)),i=r(s(4995)),d=r(s(7954)),n=r(s(6371)),u=r(s(9081)),l=r(s(4471)),c=r(s(2671)),p=r(s(1239)),f=r(s(6990)),h=r(s(4935)),m=r(s(3761)),g=r(s(7635)),y=r(s(1206)),_=r(s(8428)),M=r(s(8453)),I=r(s(4237)),v=r(s(380));t.default=class{corsAllowUrl=process.env.CLIENT_URL;app;database=new u.default(process.env.DATABASE_URL);port=process.env.PORT||3e3;setCorsHeaders=(e,t,s)=>{t.setHeader("Access-Control-Allow-Origin",this.corsAllowUrl),t.setHeader("Access-Control-Allow-Methods","GET, POST, PATCH, PUT, DELETE"),t.setHeader("Access-Control-Allow-Headers","Content-Type"),t.setHeader("Access-Control-Allow-Credentials","true"),s()};constructor(){this.app=(0,a.default)(),this.intializeMiddleware(),this.intializeRoutes()}listen(){this.app.listen(this.port,(async()=>{try{await this.database.connectToDb().then((()=>{console.log(`âš¡ï¸[server]: Server is running at port ${this.port} `)}))}catch(e){console.error(`Failed to start server: ${e}`)}}))}intializeMiddleware(){this.app.use((0,o.default)({origin:process.env.CLIENT_URL,credentials:!0})),this.app.use(a.default.json()),this.app.use((0,d.default)()),this.app.use(this.setCorsHeaders),this.app.use(a.default.urlencoded({extended:!0})),this.app.use((0,i.default)()),this.app.disable("x-powered-by")}intializeRoutes(){this.app.get("/",((e,t)=>{t.json({message:"Hello from server"}).end()})),this.app.use("/api/notification",n.default.validate,m.default),this.app.use("/api/podcasts",n.default.validate,g.default),this.app.use("/api",y.default),this.app.use("/api/user",l.default),this.app.use("/api/post",n.default.validate,c.default),this.app.use("/api/comment",n.default.validate,p.default),this.app.use("/api/group",n.default.validate,f.default),this.app.use("/api/meetup",n.default.validate,h.default),this.app.use("/api/tags",n.default.validate,_.default),this.app.use("/api/report",n.default.validate,M.default),this.app.use("/api/search",n.default.validate,I.default),this.app.use("/api/message",n.default.validate,v.default)}async connectDb(){return this.database.connectToDb()}}},1488:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.cloudinaryConfig=void 0,r(s(1094)).default.config(),t.cloudinaryConfig={api_key:process.env.CLOUDINARY_API_KEY,api_secret:process.env.CLOUDINARY_API_SECRET,secure:!0,cloud_name:process.env.CLOUDINARY_API_CLOUD_NAME}},1805:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.client=void 0;const a=s(7902);r(s(1094)).default.config(),t.client=new a.Redis({url:"https://engaged-liger-45328.upstash.io",token:"AbEQASQgZjhkNjRmMTYtZGI4NS00ODVjLTk5NTctZWU5MzY5NDZkZjNmZjY1MWY1MjkwNTgzNGI4ZTllMjAxNWIxY2VjN2I4MTI="})},1285:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{commentService;constructor(e){this.commentService=e}createComment(e,t){const{author:s,comment:r,postId:a}=e.body;return s&&a&&r?this.commentService.uploadComment(e,t):t.status(400).json({message:"Author, Post ID and comment are required"})}getReplies(e,t){return e.params.id?this.commentService.getCommentReplies(e,t):t.status(400).json({message:"Id is required",error:!0})}like(e,t){const{userId:s,commentId:r}=e.body;return s&&r?this.commentService.likeComment(e,t):t.status(400).json({message:"user id and comment id are required",error:!0})}}},4485:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{groupService;constructor(e){this.groupService=e}create(e,t){return this.groupService.createGroup(e,t)}getGroupById(e,t){return e.query.id?this.groupService.getGroup(e,t):t.status(400).json({message:"id is required",error:!0})}allGroups(e){return this.groupService.getAllGroups(e)}join(e,t){return this.groupService.joinGroup(e,t)}leave(e,t){return this.groupService.leaveGroup(e,t)}getAllGroupsWhereUserIn(e,t){return this.groupService.getGroupsWhereUserIsAdminOrMember(e,t)}delete(e,t){return this.groupService.deleteGroup(e,t)}update(e,t){return this.groupService.updateGroup(e,t)}}},6853:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{meetup;constructor(e){this.meetup=e}create(e,t){const{address:s,companyName:r,date:a,image:o,title:i,body:d,author:n,assetId:u,category:l}=e.body;return s&&r&&a&&i&&d&&n&&o&&u&&l?this.meetup.createMeetup(e,t):t.status(400).json({message:"Please provide values for all required fields.",error:!0})}allMeetups(e,t){return this.meetup.getAllMeetups(e,t)}getMeetupById(e,t){return e.query.id?this.meetup.getMeetup(e,t):t.status(400).json({message:"Id is required",error:!0})}delete(e,t){return this.meetup.deleteMeetup(e,t)}update(e,t){return this.meetup.updateMeetup(e,t)}}},3246:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{messageService;constructor(e){this.messageService=e}create(e,t){return this.messageService.createConversation(e,t)}send(e,t){return this.messageService.sendMessage(e,t)}allConverstation(e,t){return this.messageService.getAllConversation(e,t)}chat(e,t){return this.messageService.getChat(e,t)}unReadChat(e,t){return this.messageService.getUnreadChat(e,t)}updateIsRead(e,t){return this.messageService.updateIsRead(e,t)}}},6406:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{notificationService;constructor(e){this.notificationService=e}create(e,t){return this.notificationService.createNotification(e,t)}deleteNotification(e,t){return this.notificationService.deleteNotification(e,t)}getAllNotifications(e,t){return this.notificationService.getAllNotification(e,t)}}},4174:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{podcastService;constructor(e){this.podcastService=e}createPodcast(e,t){const{audio:s,audioAssetId:r,body:a,tags:o,postImage:i,title:d,author:n,postImageAssetId:u,category:l}=e.body;return s&&r&&a&&!(o.length<1)&&i&&d&&n&&u&&l&&l?this.podcastService.create(e,t):t.status(400).json({message:"Please provide all value for all required fields",error:!0})}getAll(e,t){return this.podcastService.getAllPodcasts(e,t)}getPodcast(e,t){return e.query.id?this.podcastService.getPodcastById(e,t):t.status(400).json({message:"id not provided",error:!0})}delete(e,t){return this.podcastService.deletePodcast(e,t)}}},3185:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{postService;constructor(e){this.postService=e}create(e,t){const{title:s,body:r,image:a,assetId:o,category:i}=e.body;return s&&r&&a&&o&&i?this.postService.createPost(e,t):t.status(400).json({message:"Please fill all required fields",error:!0})}getPostById(e,t){return e.query.id?this.postService.getPost(e,t):t.status(400).json({message:"Id is required",error:!0})}allPosts(e,t){const{sort:s="popular",page:r=1}=e.query;return["newest","popular"].includes(s)?(r&&+r<1&&(e.query.page=1),this.postService.getAllPosts(e,t)):t.status(400).json({message:"Invalid sort options"})}updateView(e,t){const{postId:s}=e.body;return s?this.postService.incremementView(e,t):t.status(400).json({message:"Post Id is required"})}like(e,t){const{postId:s,userId:r}=e.body;return s&&r?this.postService.likePost(e,t):t.status(400).json({message:"post id and user id are required",error:!0})}relatedPosts(e,t){const{id:s,authorId:r}=e.query;return s&&r?this.postService.getRelatedPosts(e,t):t.status(400).json({message:"id and author id are required",error:!0})}share(e,t){const{postId:s}=e.body;return s?this.postService.sharePost(e,t):t.status(400).json({message:"Post Id is required",error:!0})}deleteAPost(e,t){const{postId:s}=e.body;return s?this.postService.deletePost(e,t):t.status(400).json({message:"Post Id is required",error:!0})}update(e,t){return this.postService.updatePost(e,t)}}},4631:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{reportService;constructor(e){this.reportService=e}reportPost(e,t){return this.reportService.reportPost(e,t)}}},7782:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{_searchService;constructor(e){this._searchService=e}searchAll(e,t){return this._searchService.search(e,t)}}},1548:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{tagService;constructor(e){this.tagService=e}getAllTags(e){return this.tagService.getAllTags(e)}}},644:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{userService;constructor(e){this.userService=e}create(e,t){const{email:s,id:r,password:a}=e.body;return s&&r&&a?this.userService.createUser(e,t):t.status(400).json({message:"Email,user id, username and password are required",error:!0}).end()}getUserById(e,t){return e.query.id?this.userService.getUser(e,t):t.status(400).json({message:"id is required",error:!0})}followUser(e,t){return this.userService.handleFollow(e,t)}listAllUsers(e,t){return this.userService.getAllUsers(e,t)}}},3607:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),(new(r(s(7097)).default)).listen()},6371:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{static async validate(e,t,s){try{const r=e.headers.authorization?.split(" ")[1];return r?s():t.status(403).json({message:"Unauthorized",error:!0}).end()}catch(e){return t.status(500).json({message:"Internal Server Error",error:!0}).end()}}}},2804:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=s(3954),a=new r.Schema({author:{type:String,ref:"User"},comment:String,likes:[{type:String,ref:"User"}],postId:{type:r.Schema.Types.ObjectId,ref:"Post"},parentId:{type:r.Schema.Types.ObjectId,ref:"Comment",required:!1}},{timestamps:!0}),o=(0,r.model)("Comment",a);t.default=o},2841:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=s(3954),a=new r.Schema({name:{type:String,required:!0},banner:{type:String,required:!0},bannerAssetId:{type:String,required:!0},category:{type:String,required:!0},logo:{type:String,required:!0},logoAssetId:{type:String,required:!0},description:{type:String,required:!0},members:[{type:String,ref:"User"}],admins:[{type:String,ref:"User"}],tags:[{type:r.Schema.Types.ObjectId,ref:"Tag"}],posts:[{type:r.Schema.Types.ObjectId,ref:"Post"}]},{timestamps:!0});a.index({name:"text",category:"text"});const o=(0,r.model)("Group",a);t.default=o},7979:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=s(3954),a=new r.Schema({title:{type:String,required:!0},category:{type:String,required:!0},image:{type:String,required:!0},assetId:{type:String,required:!0},address:{type:String,required:!0},companyName:{type:String,required:!0},date:{type:String,required:!0},body:{type:String,required:!0},tags:[{type:r.Schema.Types.ObjectId,ref:"Tag"}],author:{type:String,ref:"User"}},{timestamps:!0});a.index({title:"text",companyName:"text"});const o=(0,r.model)("Meetup",a);t.default=o},6815:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.chatModel=void 0;const r=s(3954),a=new r.Schema({content:String,media:{image:{type:String,required:!1},imageAssetId:{type:String,required:!1},audio:{type:String,required:!1},audioAssetId:{type:String,required:!1},video:{type:String,required:!1},videoAssetId:{type:String,required:!1}},is_read:{type:Boolean,default:!1},senderId:{type:String,ref:"User"},receiverId:{type:String,ref:"User"},messageId:{type:String,ref:"message"}},{timestamps:!0});t.chatModel=(0,r.model)("Chat",a);const o=new r.Schema({members:[{type:String,ref:"User"}],messages:[{type:r.Schema.Types.ObjectId,ref:"Chat"}]},{timestamps:!0}),i=(0,r.model)("Message",o);t.default=i},6424:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=s(3954),a=new r.Schema({notificationType:{type:String,required:!0},message:String,to:{type:String,ref:"User"},from:{type:String,ref:"User"},is_read:{type:Boolean,default:!1},postId:{type:r.Schema.Types.ObjectId,required:!0},modelPath:String,comments:{type:String,required:!1}},{timestamps:!0}),o=(0,r.model)("Notification",a);t.default=o},2594:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=s(3954),a=new r.Schema({audio:{type:String,required:!0},audioAssetId:{type:String,required:!0},author:{type:String,required:!0,ref:"User"},category:{type:String,required:!0},title:{type:String,required:!0},body:{type:String,required:!0},postImage:{type:String,required:!0},postImageAssetId:{type:String,required:!0},tags:[{type:r.Schema.Types.ObjectId,ref:"Tag"}]},{timestamps:!0});a.index({title:"text"});const o=(0,r.model)("Podcasts",a);t.default=o},5435:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=s(3954),a=new r.Schema({title:String,body:String,category:{type:String,required:!0},views:{type:Number,default:0},assetId:{type:String,required:!0},image:{type:String,required:!0},tags:[{type:r.Schema.Types.ObjectId,ref:"Tag"}],share:{type:Number,default:0},country:{type:String,required:!1},group:{type:r.Schema.Types.ObjectId,ref:"Group",required:!1},likes:[{type:String,ref:"User"}],comments:[{type:r.Schema.Types.ObjectId,ref:"Comment"}],author:{type:String,ref:"User"},report:[{type:r.Schema.Types.ObjectId,ref:"Report"}]},{timestamps:!0});a.index({title:"text",body:"text"});const o=(0,r.model)("Post",a);t.default=o},8583:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=s(3954),a=new r.Schema({postId:r.Schema.Types.ObjectId,reasons:[String],reportBy:{type:String,ref:"User"}},{timestamps:!0}),o=(0,r.model)("Report",a);t.default=o},1152:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=s(3954),a=new r.Schema({name:{type:String,unique:!0},postIds:[{type:r.Schema.Types.ObjectId,ref:"Post"}]}),o=(0,r.model)("Tag",a);t.default=o},5805:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=s(3954),a=new r.Schema({_id:{type:String,required:!0},username:{type:String,required:!0},password:{type:String,required:!0},email:{type:String,required:!0},region:{type:String,required:!1},country:{type:String,required:!1},points:{type:Number,default:0},profileImage:{type:String,required:!1},role:{type:String,required:!1,default:""},bio:{type:String,required:!1,default:""},website:{type:String,required:!1,default:""},followers:[{type:String,ref:"User"}],followings:[{type:String,ref:"User"}],posts:[{type:r.Schema.Types.ObjectId,ref:"Post"}],groups:[{type:r.Schema.Types.ObjectId,ref:"Group"}],groupMembers:[{type:r.Schema.Types.ObjectId,ref:"Group"}],meetups:[{type:r.Schema.Types.ObjectId,ref:"Meetup"}],podcasts:[{type:r.Schema.Types.ObjectId,ref:"Podcasts"}],notifications:[{type:r.Schema.Types.ObjectId,ref:"Notification"}]},{timestamps:!0});a.index({_id:"text",username:"text",email:"text"});const o=(0,r.model)("User",a);t.default=o},9233:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.podcastQueue=void 0;const a=r(s(5663));t.podcastQueue=new a.default("podcastQueue",{redis:{host:"127.0.0.1",port:6379}})},1239:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(864),o=r(s(1285)),i=r(s(2804)),d=r(s(5435)),n=r(s(6172)),u=(0,a.Router)(),l=new n.default(i.default,d.default),c=new o.default(l);u.get("/:id",((e,t)=>c.getReplies(e,t))),u.post("/create",((e,t)=>c.createComment(e,t))),u.post("/like",((e,t)=>c.like(e,t))),t.default=u},1206:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(864),o=r(s(1461)),i=r(s(7871)),d=(0,a.Router)(),n=o.default.memoryStorage(),u=(0,o.default)({storage:n}),l=new i.default;d.post("/upload",u.single("file"),((e,t)=>l.upload(e,t))),t.default=d},6990:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(864),o=r(s(1152)),i=r(s(2841)),d=r(s(4485)),n=r(s(5805)),u=r(s(8286)),l=(0,a.Router)(),c=new u.default(i.default,o.default,n.default),p=new d.default(c);l.post("/join",((e,t)=>p.join(e,t))),l.post("/leave",((e,t)=>p.leave(e,t))),l.get("/all",((e,t)=>p.allGroups(t))),l.get("/",((e,t)=>p.getGroupById(e,t))),l.get("/group-member",((e,t)=>p.getAllGroupsWhereUserIn(e,t))),l.post("/create",((e,t)=>p.create(e,t))),l.post("/update",((e,t)=>p.update(e,t))),l.patch("/delete",((e,t)=>p.delete(e,t))),t.default=l},4935:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(864),o=r(s(1152)),i=r(s(5805)),d=r(s(7979)),n=r(s(3586)),u=r(s(6853)),l=(0,a.Router)(),c=new n.default(d.default,o.default,i.default),p=new u.default(c);l.get("/",((e,t)=>p.getMeetupById(e,t))),l.get("/all",((e,t)=>p.allMeetups(e,t))),l.post("/create",((e,t)=>p.create(e,t))),l.patch("/delete",((e,t)=>p.delete(e,t))),l.post("/update",((e,t)=>p.update(e,t))),t.default=l},380:function(e,t,s){var r=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,a)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&r(t,e,s);return a(t,e),t},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const d=s(864),n=i(s(1820)),u=o(s(6815)),l=i(s(3246)),c=(0,d.Router)(),p=new n.default(u.default,u.chatModel),f=new l.default(p);c.post("/send",((e,t)=>f.send(e,t))),c.get("/all-conversation",((e,t)=>f.allConverstation(e,t))),c.get("/chat",((e,t)=>f.chat(e,t))),c.get("/unread-chat",((e,t)=>f.unReadChat(e,t))),c.post("/create",((e,t)=>f.create(e,t))),c.post("/update-is-read",((e,t)=>f.updateIsRead(e,t))),t.default=c},3761:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(864),o=r(s(6424)),i=r(s(5805)),d=r(s(6406)),n=r(s(5057)),u=(0,a.Router)(),l=new d.default(new n.default(o.default,i.default));u.post("/create",((e,t)=>l.create(e,t))),u.post("/delete",((e,t)=>l.deleteNotification(e,t))),u.get("/all-notifications",((e,t)=>l.getAllNotifications(e,t))),t.default=u},7635:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(864),o=r(s(4174)),i=r(s(1152)),d=r(s(2594)),n=r(s(5805)),u=r(s(8399)),l=(0,a.Router)(),c=new u.default(d.default,n.default,i.default),p=new o.default(c);l.get("/all",((e,t)=>p.getAll(e,t))),l.post("/create",((e,t)=>p.createPodcast(e,t))),l.get("/",((e,t)=>p.getPodcast(e,t))),l.patch("/delete",((e,t)=>p.delete(e,t))),t.default=l},2671:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(864),o=r(s(3185)),i=r(s(5435)),d=r(s(1152)),n=r(s(5805)),u=r(s(2841)),l=r(s(7440)),c=(0,a.Router)(),p=new l.default(i.default,d.default,n.default,u.default),f=new o.default(p);c.post("/share",((e,t)=>f.share(e,t))),c.get("/related-posts",((e,t)=>f.relatedPosts(e,t))),c.post("/like",((e,t)=>f.like(e,t))),c.post("/increment-view",((e,t)=>f.updateView(e,t))),c.get("/all",((e,t)=>f.allPosts(e,t))),c.get("/",((e,t)=>f.getPostById(e,t))),c.post("/create",((e,t)=>f.create(e,t))),c.patch("/delete",((e,t)=>f.deleteAPost(e,t))),c.post("/update",((e,t)=>f.update(e,t))),t.default=c},8453:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(864),o=r(s(1978)),i=r(s(8583)),d=r(s(5435)),n=r(s(4631)),u=(0,a.Router)(),l=new o.default(i.default,d.default),c=new n.default(l);u.post("/report-post",((e,t)=>c.reportPost(e,t))),t.default=u},4237:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(864),o=r(s(2580)),i=r(s(5435)),d=r(s(2841)),n=r(s(2594)),u=r(s(7782)),l=r(s(7979)),c=(0,a.Router)(),p=new o.default(l.default,i.default,d.default,n.default),f=new u.default(p);c.get("/all",((e,t)=>f.searchAll(e,t))),t.default=c},8428:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(864),o=r(s(1548)),i=r(s(1268)),d=r(s(5435)),n=r(s(1152)),u=(0,a.Router)(),l=new i.default(d.default,n.default),c=new o.default(l);u.get("/all-tags",((e,t)=>c.getAllTags(t))),t.default=u},4471:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(864),o=r(s(6371)),i=r(s(5805)),d=r(s(6717)),n=r(s(644)),u=(0,a.Router)(),l=new d.default(i.default),c=new n.default(l);u.post("/create",((e,t)=>c.create(e,t))),u.get("/",o.default.validate,((e,t)=>c.getUserById(e,t))),u.get("/all-users",((e,t)=>c.listAllUsers(e,t))),u.post("/follow",o.default.validate,((e,t)=>c.followUser(e,t))),t.default=u},6172:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=s(8067);t.default=class{commentModel;postModel;constructor(e,t){this.commentModel=e,this.postModel=t}async uploadComment(e,t){try{const{author:s,comment:r,postId:a,parentId:o}=e.body,i=await this.postModel.findById(a);if(!i)return t.status(404).json({message:"Post not found",error:!0}).end();const d=await this.commentModel.create({author:s,comment:r,postId:i.id,...o&&{parentId:o}});return i.comments.push(d.id),await i.save(),t.json({message:"Comment uploaded",error:!1})}catch(e){(0,r.createError)(e,t)}}async getCommentReplies(e,t){try{const s=await this.commentModel.find({parentId:e.params.id}).populate("author","username profileImage createdAt updateAt");return s?.length<1?t.status(404).json({message:"No replies yet",error:!0}):t.status(200).json({data:s,error:!1}).end()}catch(e){(0,r.createError)(e,t)}}async likeComment(e,t){const{userId:s,commentId:a}=e.body;try{const e=await this.commentModel.findById(a);if(!e)return t.status(404).json({message:"Comment not found",error:!0});const r=e.likes.indexOf(s);return-1!==r?e.likes.splice(r,1):e.likes.push(s),await e.save(),t.status(200).end()}catch(e){(0,r.createError)(e,t)}}}},9081:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{databaseUrl;constructor(e){this.databaseUrl=e}async connectToDb(){try{const e=await Promise.resolve().then(s.t.bind(s,3954,23));if(!this.databaseUrl)throw new Error("Database url is required");await e.connect(this.databaseUrl),console.log("success connect to db ðŸŽ‰")}catch(e){throw e}}}},7871:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(s(3349)),o=s(1488),i=s(8067);t.default=class{async upload(e,t){try{if(e.file){a.default.v2.config(o.cloudinaryConfig);const s=Buffer.from(e.file.buffer).toString("base64");let r="data:"+e.file.mimetype+";base64,"+s;const i=await a.default.v2.uploader.upload(r,{resource_type:"auto"});t.status(200).json({error:!1,public_id:i.public_id,secure_url:i.secure_url,thumbnail:i.placeholder}).end()}}catch(e){console.log(e),(0,i.createError)(e,t)}}async deleteAsset(e,t){try{a.default.v2.config(o.cloudinaryConfig),await a.default.v2.uploader.destroy(e)}catch(e){(0,i.createError)(e,t)}}}},8286:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(s(1268)),o=r(s(6717)),i=s(8067),d=r(s(7871));t.default=class{groupModel;tagModel;userModel;constructor(e,t,s){this.groupModel=e,this.tagModel=t,this.userModel=s}isAdmin(e,t){return e.findIndex((e=>t.includes(e)))}async createTagsForGroup(e,t){await new a.default(this.groupModel,this.tagModel).createTagIfExists(e,t)}async populateGroupFieldWithUsers(e,t,s){for(const r of e){await this.groupModel.findByIdAndUpdate(s,{$push:{[t]:r}});const e=new o.default(this.userModel);"members"===t?await e.updateGroupFields(r,"groupMembers",s):await e.updateGroupFields(r,"groups",s)}}async createGroup(e,t){try{const{admins:s,tags:r,members:a,banner:o,description:i,logo:d,name:n,bannerAssetId:u,logoAssetId:l,category:c}=e.body;if(-1!==this.isAdmin(s,a))return t.status(400).json({message:"The user cannot be both a regular member and an admin simultaneously.",error:!0});const p=await this.groupModel.create({banner:o,description:i,logo:d,name:n,bannerAssetId:u,logoAssetId:l,category:c});await this.userModel.findByIdAndUpdate(s[0],{$inc:{points:5}}),r&&r.length>=1&&await this.createTagsForGroup(r,p.id),await Promise.all([this.populateGroupFieldWithUsers(s,"admins",p._id),this.populateGroupFieldWithUsers(a,"members",p._id)]),t.status(201).json({message:"Group has been created",error:!1}).end()}catch(e){(0,i.createError)(e,t)}}async getGroup(e,t){try{const s=await this.groupModel.findById(e.query.id).populate({path:"posts",model:"Post",populate:[{path:"author",model:"User",select:"username _id profileImage"},{path:"group",model:"Group"},{path:"tags",model:"Tag"}]}).populate("admins","_id username profileImage").populate("members","_id username profileImage").populate("tags");return s?(t.setHeader("Cache-Control","public, max-age=3600"),t.json({data:s,error:!1})):t.status(404).json({message:"Group not found",error:!0})}catch(e){(0,i.createError)(e,t)}}async getAllGroups(e){try{const t=await this.groupModel.find({}).populate("admins","username _id profileImage").populate("members","username _id profileImage").populate("tags").populate({path:"posts",populate:[{path:"author",model:"User"},{path:"group",model:"Group"}]});return e.setHeader("Cache-Control","public, max-age=3600"),e.status(200).json({data:t,error:!1})}catch(t){(0,i.createError)(t,e)}}async joinGroup(e,t){try{const{groupId:s,userId:r}=e.body,a=await this.groupModel.findById(s);if(!a)return t.status(404).json({message:"Group not found",error:!0}).end();if(-1!==a.members.indexOf(r))return t.status(400).json({message:"You already member of this group"});a.members.push(r),await a.save(),t.status(200).end()}catch(e){(0,i.createError)(e,t)}}async leaveGroup(e,t){try{const{groupId:s,userId:r}=e.body,a=await this.groupModel.findById(s);if(!a)return t.status(404).json({message:"Group not found",error:!0}).end();const o=a.members.indexOf(r);if(-1===o)return t.status(400).json({message:"You are not member of this group"});a.members.splice(o,1),await a.save(),t.status(200).end()}catch(e){(0,i.createError)(e,t)}}async getGroupsWhereUserIsAdminOrMember(e,t){try{const s=await this.groupModel.find({$or:[{admins:{$in:[e.query.admins]}},{members:{$in:[e.query.members]}}]}).populate("admins","username");return t.json({data:s,error:!1})}catch(e){(0,i.createError)(e,t)}}async deleteGroup(e,t){try{const s=await this.groupModel.findById(e.body.groupId);if(!s)return t.status(404).json({message:"Group not found",error:!0});if(s.admins){const e=await this.userModel.findById(s.admins[0]);if(!e)return t.status(404).json({message:"Admin not found",error:!0});const r=e.groups.filter((e=>e!==s._id));await this.userModel.updateOne({_id:e._id},{$set:{updatedGroups:r}}),await e.save()}const r=new d.default;await Promise.all([r.deleteAsset(s.bannerAssetId,t),r.deleteAsset(s.logoAssetId,t)]),await new a.default(this.groupModel,this.tagModel).deleteTag(s.tags,s._id),await this.groupModel.deleteOne({_id:s._id}),t.status(201).end()}catch(e){(0,i.createError)(e,t)}}async updateGroup(e,t){try{const{groupId:s,admins:r,tags:a,members:o,banner:i,description:n,logo:u,name:l,category:c,bannerAssetId:p,logoAssetId:f}=e.body,h=await this.groupModel.findById(s);if(!h)return t.status(404).json({message:"Group not found",error:!0});if(-1!==this.isAdmin(r,o))return t.status(400).json({message:"The user cannot be both a regular member and an admin simultaneously.",error:!0});const m=new d.default;p!==h.bannerAssetId&&await m.deleteAsset(h.bannerAssetId,t),f!==h.logoAssetId&&await m.deleteAsset(h.logoAssetId,t),a&&a.length>=1&&await this.createTagsForGroup(a,h.id),await this.groupModel.updateOne({_id:h._id},{banner:i,description:n,logo:u,name:l,category:c}),t.status(201).end()}catch(e){console.log(e),(0,i.createError)(e,t)}}}},3586:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(s(1268)),o=r(s(7871)),i=r(s(1268)),d=s(8067);t.default=class{meetupModel;tagModel;userModel;constructor(e,t,s){this.meetupModel=e,this.tagModel=t,this.userModel=s}async createMeetup(e,t){try{const{address:s,companyName:r,date:o,image:i,title:d,tags:n,body:u,author:l,assetId:c,category:p}=e.body,f=await this.userModel.findById(l);if(!f)return t.status(404).json({message:"User not found",error:!0});const h=await this.meetupModel.create({address:s,companyName:r,date:o,image:i,title:d,body:u,author:l,assetId:c,category:p});await new a.default(this.meetupModel,this.tagModel).createTagIfExists(n,h.id),f.meetups.push(h.id),f.points+=5,await f.save(),t.status(201).json({data:h,error:!1}).end()}catch(e){(0,d.createError)(e,t)}}async getAllMeetups(e,t){try{const{page:s=1,limit:r=10}=e.query,[a,o]=await Promise.all([this.meetupModel.countDocuments(),this.meetupModel.find({}).populate("author","_id username profileImage createdAt").populate("tags").skip(((s?+s:1)-1)*+r).limit(+r)]),i=Math.ceil(a/+r);return t.status(200).json({data:{totalPages:i,meetups:o},error:!1})}catch(e){(0,d.createError)(e,t)}}async getMeetup(e,t){try{const s=await this.meetupModel.findById(e.query.id).populate("author").populate("tags");return s?(t.setHeader("Cache-Control","public, max-age=3600"),t.status(200).json({data:s,error:!1})):t.status(404).json({message:"Meetup not found",error:!0})}catch(e){(0,d.createError)(e,t)}}async deleteMeetup(e,t){try{const s=await this.meetupModel.findById(e.body.meetupId).populate("author","_id, username profileImage createdAt");if(!s)return t.status(404).json({message:"Meetup not found",error:!0});if(s.author){const r=await this.userModel.findById(s.author);if(!r)return t.status(404).json({message:"User not found",error:!0});const a=r.meetups.filter((t=>t!==e.body.meetupId));await this.userModel.updateOne({_id:r._id},{$set:{meetups:a}}),await r.save()}const r=new o.default;await r.deleteAsset(s.assetId,t),await new i.default(this.meetupModel,this.tagModel).deleteTag(s.tags,s._id),await this.meetupModel.deleteOne({_id:s._id}),t.status(201).end()}catch(e){(0,d.createError)(e,t)}}async updateMeetup(e,t){try{const{meetupId:s,address:r,companyName:a,date:d,image:n,title:u,tags:l,body:c,assetId:p,category:f}=e.body,h=await this.meetupModel.findById(s);if(!h)return t.status(404).json({message:"Meetup not found",error:!0});if(l&&l.length>=1&&await new i.default(this.meetupModel,this.tagModel).createTagIfExists(l,h.id),p!==h.assetId){const e=new o.default;await e.deleteAsset(h.assetId,t)}await this.meetupModel.updateOne({_id:h._id},{address:r,body:c,category:f,companyName:a,image:n,title:u,assetId:p,date:d}),t.status(201).end()}catch(e){(0,d.createError)(e,t)}}}},1820:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=s(8067);t.default=class{messageModel;chatModel;constructor(e,t){this.messageModel=e,this.chatModel=t}async createConversation(e,t){try{const{members:s}=e.body;if(!await this.messageModel.findOne({members:{$all:s}})){const e=new this.messageModel({members:s});await e.save()}t.status(201).end()}catch(e){(0,r.createError)(e,t)}}async sendMessage(e,t){try{const{id:s,message:r,senderId:a,receiverId:o,media:i,messageId:d}=e.body,n=new this.chatModel({content:r,senderId:a,receiverId:o,messageId:d,...i&&{media:{...i.image&&{image:i.image?.secure_url,imageAssetId:i?.image?.public_id}}}}),u=await n.save();await this.messageModel.findOneAndUpdate({_id:s},{$push:{messages:u._id}},{new:!0}),t.status(201).end()}catch(e){(0,r.createError)(e,t)}}async getAllConversation(e,t){try{const s=await this.messageModel.find({members:{$in:[e.query.members]}}).populate("members","_id, username profileImage").populate("messages");return t.json({data:s,error:!1})}catch(e){(0,r.createError)(e,t)}}async getChat(e,t){try{const s=await this.messageModel.find({_id:e.query.id}).populate("members","_id, username profileImage").populate("messages");return t.json({data:s,error:!1})}catch(e){(0,r.createError)(e,t)}}async getUnreadChat(e,t){try{const{receiverId:s}=e.query,r=await this.chatModel.find({is_read:!1,receiverId:s}).populate("senderId","_id username profileImage");t.json({data:r,error:!1}).end()}catch(e){(0,r.createError)(e,t)}}async updateIsRead(e,t){try{const{messageId:s,senderId:r}=e.body;(await this.chatModel.find({messageId:s,senderId:r})).forEach((async e=>{await this.chatModel.findByIdAndUpdate(e._id,{is_read:!0})})),t.status(201).end()}catch(e){(0,r.createError)(e,t)}}}},5057:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=s(8067);t.default=class{notificationModel;userModel;constructor(e,t){this.notificationModel=e,this.userModel=t}async createNotification(e,t){const{to:s,from:a,message:o,type:i,postId:d,model:n,comments:u}=e.body;try{return await this.userModel.findById(s)?(await this.notificationModel.create({to:s,from:a,notificationType:i,message:o,postId:d,modelPath:n,comments:u}),t.status(200).end()):t.status(404).json({message:"User not found",error:!0})}catch(e){(0,r.createError)(e,t)}}async deleteNotification(e,t){const{type:s,postId:a,userId:o}=e.body;try{return await this.userModel.findById(o)?await this.notificationModel.find({notificationType:s,postId:a})?(await this.notificationModel.deleteOne({from:o,notificationType:s}),t.status(200).end()):t.status(404).json({message:"Notification not found"}).end():t.status(404).json({message:"User not found"}).end()}catch(e){(0,r.createError)(e,t)}}async getAllNotification(e,t){try{const{userId:s}=e.query,r=await this.notificationModel.find({to:s}).populate("from","_id username profileImage").populate({path:"postId"});return t.status(200).json({data:r,error:!1})}catch(e){(0,r.createError)(e,t)}}}},8399:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(s(1268)),o=r(s(7871)),i=r(s(1268)),d=s(8067),n=s(9233);t.default=class{podcastModel;userModel;tagModel;constructor(e,t,s){this.podcastModel=e,this.userModel=t,this.tagModel=s}async create(e,t){try{const{audio:s,audioAssetId:r,body:o,tags:i,postImage:d,title:u,author:l,postImageAssetId:c,category:p}=e.body;e.setTimeout(5e5);const f=await this.userModel.findById(l);if(!f)return t.status(404).json({message:"User not found",error:!0});const h=await this.podcastModel.create({audio:s,audioAssetId:r,body:o,postImage:d,title:u,author:l,postImageAssetId:c,category:p});return i&&i.length>=1&&await new a.default(this.podcastModel,this.tagModel).createTagIfExists(i,h.id),f.podcasts.push(h.id),f.points+=5,await f.save(),await n.podcastQueue.add(h._id),t.status(201).json({message:"Podcast has been published",error:!1})}catch(e){console.log(e),(0,d.createError)(e,t)}}async getAllPodcasts(e,t){try{const{sort:s="popular",page:r=1,limit:a=10}=e.query;let o={};o="newest"===s?{createdAt:-1}:{createdAt:1};const[i,d]=await Promise.all([this.podcastModel.countDocuments(),this.podcastModel.find().populate("author","_id username profileImage region country").populate("tags").skip(((r?+r:1)-1)*+a).limit(+a).sort(o)]),n=Math.ceil(i/+a);t.status(200).json({error:!1,data:{totalPodcasts:i,allPodcasts:d,totalPages:n}}).end()}catch(e){(0,d.createError)(e,t)}}async getPodcastById(e,t){try{const s=await this.podcastModel.findById(e.query.id).populate("author");return s?(t.setHeader("Cache-Control","public, max-age=3600"),t.status(200).json({data:s,error:!1})):t.status(404).json({message:"Podcast not found",error:!0})}catch(e){(0,d.createError)(e,t)}}async deletePodcast(e,t){try{const s=await this.podcastModel.findById(e.body.podcastId);if(!s)return t.status(404).json({message:"Podcast not found",error:!0});if(s.author){const e=await this.userModel.findById(s.author);if(!e)return t.status(404).json({message:"Author not found",error:!0});const r=e?.podcasts.filter((e=>e!==s._id));await this.userModel.updateOne({_id:e._id},{$set:{podcasts:r}}),await e.save()}const r=new o.default;await Promise.all([r.deleteAsset(s.audioAssetId,t),r.deleteAsset(s.postImageAssetId,t)]),await new i.default(this.podcastModel,this.tagModel).deleteTag(s.tags,s._id),await this.podcastModel.deleteOne({_id:s._id}),t.status(201).end()}catch(e){(0,d.createError)(e,t)}}}},7440:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(s(1268)),o=r(s(7871)),i=s(8067),d=s(1805);t.default=class{PostModel;tagModel;userModel;groupModel;constructor(e,t,s,r){this.PostModel=e,this.tagModel=t,this.userModel=s,this.groupModel=r}async createPost(e,t){try{const{title:s,body:r,image:o,author:i,tags:d,group:n,assetId:u,category:l}=e.body,c=await this.userModel.findById(i);if(!c)return t.status(404).json({message:"User not found",error:!0}).end();const p=await this.PostModel.create({title:s,body:r,image:o,author:c,assetId:u,category:l,country:"",...n?{group:n}:{group:null}});if(c?.posts.push(p.id),c.points+=5,await(c?.save()),d&&d.length>=1&&await new a.default(this.PostModel,this.tagModel).createTagIfExists(d,p.id),n){const e=await this.groupModel.findById(n);if(!e)return t.status(404).json({message:"Group not found",error:!0});e.posts.push(p.id),await e.save()}t.status(201).json({message:"Post has been created",error:!1}).end()}catch(e){(0,i.createError)(e,t)}}async getPost(e,t){try{const s=await this.PostModel.findById(e.query.id).populate("author","_id, username profileImage createdAt").populate({path:"comments",match:{parentId:{$exists:!1}},options:{sort:{createdAt:-1}},populate:{path:"author",select:{_id:1,username:1,profileImage:1}}}).populate("tags");if(!s)return t.status(404).json({message:"Post not found",error:!0});t.json({data:s,error:!1}).end()}catch(e){(0,i.createError)(e,t)}}async getAllPosts(e,t){try{const s=Math.floor(378487382*Math.random());console.time("posts"+s);const{sort:r="popular",page:a=1,limit:o=10}=e.query;let i={};i="newest"===r?{createdAt:-1}:{views:-1};const n=await d.client.get("posts"),u=await this.PostModel.countDocuments(),l=Math.ceil(u/+o);if(n)return t.json({data:{allPosts:n,totalPages:l},error:!1});{const e=await this.PostModel.find({group:null}).populate("author","username profileImage createdAt").populate("tags").skip(((a?+a:1)-1)*+o).limit(+o).sort(i);await d.client.setex("posts",4600,JSON.stringify(e)),t.status(200).json({error:!1,data:{totalPages:l,allPosts:e},totalPosts:u}).end()}console.timeEnd("posts"+s)}catch(e){(0,i.createError)(e,t)}}async incremementView(e,t){try{const{postId:s}=e.body;if(!this.PostModel.findById(s))return t.status(404).json({message:"Post not found",error:!0});await this.PostModel.findByIdAndUpdate(s,{$inc:{views:1}}),t.status(200).end()}catch(e){(0,i.createError)(e,t)}}async likePost(e,t){const{postId:s,userId:r}=e.body;try{const[e,a]=await Promise.all([this.PostModel.findById(s),this.userModel.findById(r)]);if(!a||!e)return t.status(404).json({message:"User or Post not found",error:!0});const o=e.likes.indexOf(a.id);-1!==o?e.likes.splice(o,1):e.likes.push(a.id),await e.save(),t.status(200).end()}catch(e){(0,i.createError)(e,t)}}async getRelatedPosts(e,t){const{id:s,authorId:r}=e.query;try{const e=await this.PostModel.find({author:r,group:null}).limit(4).populate("tags");t.setHeader("Cache-Control","public, max-age=3600"),t.status(200).json({data:e.filter((e=>e._id.toString()!==s))}).end()}catch(e){(0,i.createError)(e,t)}}async sharePost(e,t){try{const{postId:s}=e.body,r=await this.PostModel.findById(s);if(!r)return t.status(404).json({message:"Post not found",error:!0});await this.PostModel.findByIdAndUpdate(r._id,{$inc:{share:1}}),t.status(200).end()}catch(e){(0,i.createError)(e,t)}}async deletePost(e,t){try{const s=await this.PostModel.findById(e.body.postId).populate("tags").populate("author","_id, username profileImage createdAt");if(!s)return t.status(404).json({error:!0,message:"Post not found"});if(s.author){let e=await this.userModel.findById(s?.author);if(!e)return t.status(404).json({message:"User not found"});const r=e.posts.filter((e=>e.toString()!==s._id.toString()));await this.userModel.updateOne({_id:e._id},{$set:{posts:r}}),await(e?.save())}const r=new o.default;await r.deleteAsset(s.assetId,t),await new a.default(this.PostModel,this.tagModel).deleteTag(s.tags,s._id),await this.PostModel.deleteOne({_id:s._id}),t.status(201).end()}catch(e){(0,i.createError)(e,t)}}async updatePost(e,t){try{const{postId:s,title:r,image:i,assetId:d,body:n,category:u,tags:l}=e.body,c=await this.PostModel.findById(s);if(!c)return t.status(404).json({message:"Post not found",error:!0});if(l&&l.length>=1&&await new a.default(this.PostModel,this.tagModel).createTagIfExists(l,c.id),d!==c.assetId){const e=new o.default;await e.deleteAsset(c.assetId,t)}await this.PostModel.updateOne({_id:c._id},{title:r,body:n,category:u,image:i,assetId:d}),t.status(201).end()}catch(e){(0,i.createError)(e,t)}}}},1978:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=s(8067);t.default=class{reportModel;postModel;constructor(e,t){this.reportModel=e,this.postModel=t}async reportPost(e,t){try{const{postId:s,reasons:r,userId:a}=e.body,o=await this.postModel.findById(s);if(!o)return t.status(404).json({message:"Post not found",error:!1});const i=await this.reportModel.create({postId:o._id,reportBy:a,reasons:[...r]});o.report.push(i._id),await o.save(),t.status(201).json({message:"This post has been reported",error:!1}).end()}catch(e){(0,r.createError)(e,t)}}}},2580:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=s(8067);t.default=class{meetupModel;postModel;groupModel;podcastModel;constructor(e,t,s,r){this.meetupModel=e,this.postModel=t,this.groupModel=s,this.podcastModel=r}async search(e,t){try{const{searchTerm:s}=e.query,r=new RegExp(`^${s}`,"i"),a=await Promise.all([this.meetupModel.find({$text:{$search:r,$caseSensitive:!1}}),this.groupModel.find({$text:{$search:r,$caseSensitive:!1}}),this.postModel.find({$text:{$search:r,$caseSensitive:!1}}),this.podcastModel.find({$text:{$search:r,$caseSensitive:!1}})]);t.status(200).json({data:{meetups:a[0],groups:a[1],post:a[2],podcasts:a[3]}}).end()}catch(e){(0,r.createError)(e,t)}}}},1268:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{model;tagModel;constructor(e,t){this.model=e,this.tagModel=t}async createTagIfExists(e,t){try{const s=new Set;if(this.tagModel&&this.model){for(const r of[...new Set(e)]){const[e]=await Promise.all([this.tagModel.findOneAndUpdate({name:r},{$setOnInsert:{name:r},$push:{postIds:t}},{upsert:!0,new:!0})]);s.add(e._id)}return await this.model.findByIdAndUpdate(t,{tags:[...s]}),[...s]}}catch(e){throw e}}async getAllTags(e){try{if(this.tagModel){const t=await this.tagModel.find().sort({postIds:-1}).limit(5);return e.json({data:t,error:!1})}}catch(t){return e.status(500).json({error:t})}}async deleteTag(e,t){try{e.forEach((async e=>{let s=await this.tagModel.findById(e._id);if(s)if(1===s.postIds.length)await this.tagModel.deleteOne({name:s.name});else{let e=s.postIds.filter((e=>e.toString()!==t.toString()));s.postIds=e,await s.save()}}))}catch(e){throw e}}}},6717:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(s(9954)),o=s(8067);t.default=class{userModel;constructor(e){this.userModel=e}async createUser(e,t){try{const{email:s,id:r,image:o,password:i,username:d}=e.body;a.default.hash(i,10,(async(e,a)=>e?t.status(400).json({message:"Failed to hash password",error:!0}):(await this.userModel.create({email:s,...o&&{profileImage:o},_id:r,password:a,username:d}),t.status(201).json({message:"User created",error:!1}).end())))}catch(e){(0,o.createError)(e,t)}}async getUser(e,t){try{const s=await this.userModel.findById(e.query.id).populate({path:"posts",populate:[{path:"author"},{path:"tags"}]}).populate("groups").populate("meetups").populate({path:"podcasts",populate:{path:"author"}});if(!s)return t.status(404).json({message:"User not found",error:!0});t.json({data:s,error:!1}).end()}catch(e){(0,o.createError)(e,t)}}async updateGroupFields(e,t,s){try{const r=await this.userModel.findById(e);if(!r)throw new Error("User not found");r[t].push(s),await r.save()}catch(e){throw e}}async handleFollow(e,t){try{const{userId:s,followerId:r}=e.body,a=await this.userModel.findById(s);let o=await this.userModel.findById(r);if(!a||!o)return t.status(404).json({message:"User not found",error:!1});const i=a.followers.indexOf(r);-1===i?(a.followers.push(r),o.followings.push(a._id)):(a.followers.splice(i,1),o.followings=o.followings.filter((e=>e!==a._id.toString()))),await Promise.all([a.save(),o.save()]),t.status(200).end()}catch(e){(0,o.createError)(e,t)}}async getAllUsers(e,t){try{const s=await this.userModel.find({_id:{$ne:e.query.userId}}).select("_id username profileImage createdAt");return t.json({data:s,error:!1})}catch(e){(0,o.createError)(e,t)}}}},8067:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createError=void 0,t.createError=function(e,t){e instanceof Error?t.status(500).json({message:e.message,error:!0}).end():t.status(500).json({message:"An unknown error occurred",error:!0}).end()}},9954:e=>{e.exports=bcrypt},5663:e=>{e.exports=bull},3349:e=>{e.exports=cloudinary},7954:e=>{e.exports=compression},9973:e=>{e.exports=cors},5876:e=>{if("undefined"==typeof crypto){var t=new Error("Cannot find module 'crypto'");throw t.code="MODULE_NOT_FOUND",t}e.exports=crypto},1094:e=>{e.exports=dotenv},864:e=>{e.exports=express},4995:e=>{e.exports=helmet},3954:e=>{e.exports=mongoose},1461:e=>{e.exports=multer}},i={};function d(e){var t=i[e];if(void 0!==t)return t.exports;var s=i[e]={exports:{}};return o[e].call(s.exports,s,s.exports,d),s.exports}d.m=o,d.x=()=>{var e=d.O(void 0,[902],(()=>d(3607)));return d.O(e)},e=[],d.O=(t,s,r,a)=>{if(!s){var o=1/0;for(l=0;l<e.length;l++){for(var[s,r,a]=e[l],i=!0,n=0;n<s.length;n++)(!1&a||o>=a)&&Object.keys(d.O).every((e=>d.O[e](s[n])))?s.splice(n--,1):(i=!1,a<o&&(o=a));if(i){e.splice(l--,1);var u=r();void 0!==u&&(t=u)}}return t}a=a||0;for(var l=e.length;l>0&&e[l-1][2]>a;l--)e[l]=e[l-1];e[l]=[s,r,a]},s=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,d.t=function(e,r){if(1&r&&(e=this(e)),8&r)return e;if("object"==typeof e&&e){if(4&r&&e.__esModule)return e;if(16&r&&"function"==typeof e.then)return e}var a=Object.create(null);d.r(a);var o={};t=t||[null,s({}),s([]),s(s)];for(var i=2&r&&e;"object"==typeof i&&!~t.indexOf(i);i=s(i))Object.getOwnPropertyNames(i).forEach((t=>o[t]=()=>e[t]));return o.default=()=>e,d.d(a,o),a},d.d=(e,t)=>{for(var s in t)d.o(t,s)&&!d.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},d.f={},d.e=e=>Promise.all(Object.keys(d.f).reduce(((t,s)=>(d.f[s](e,t),t)),[])),d.u=e=>e+".bundle.js",d.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),d.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a={179:1},d.O.require=e=>a[e],d.f.require=(e,t)=>{a[e]||(e=>{var t=e.modules,s=e.ids,r=e.runtime;for(var o in t)d.o(t,o)&&(d.m[o]=t[o]);r&&r(d);for(var i=0;i<s.length;i++)a[s[i]]=1;d.O()})(require("./"+d.u(e)))},r=d.x,d.x=()=>(d.e(902),r()),d.x()})();